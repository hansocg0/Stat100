---
title: "Stat100 Paper"
author: "Charlie Hanson and Henry Lampton"
format: html
editor_options: 
  chunk_output_type: console
---
## Introduction

 Throughout this semester, we studied population density by county's effect on graduation rate over several of the largest and most highly populous states. These were Florida, New York, and Texas. We gathered graduation data from the board of education websites from each of these states and the population by county data from the World Population Review website. Our hypothesis was that the counties with lower population density would generally have a greater graduation rate. 
  We began with Florida. The third most highly populated state in the US, it had the least variance from its most dense county to its least. 
```{r}
#| include: False
library(tidyverse)
library(janitor)
library(lubridate)
library(RColorBrewer) 
```
```{r}
#| include: False
library(readxl)
### Florida ###
Florida2023 <-
  read_excel("Florida2023.xlsx")

FloridaPop <- 
  read.csv("FloridaPop.csv")
```

```{r}
#| include: False
### Clean Florida ###
FloridaPop <- FloridaPop |>
  select(county, densityMi, rank) |>
  mutate(county = sub(" County", "", county, fixed= TRUE))

Florida2023 <- Florida2023 |>
  mutate(county = `High School Graduation Rate, Percent of Student Cohort Since 9th Grade, 2022-23`) |>
  mutate( Graduation_Rate = ...2) |>
  select(county, Graduation_Rate)

Florida2023 <- Florida2023[-(1:2),]

Florida2023 <- left_join(Florida2023, FloridaPop)

Florida2023 <- Florida2023 |>
  mutate(Graduation_Rate = substr( Graduation_Rate, start = 1, stop = 4)) |>
  mutate( Graduation_Rate = as.numeric( Graduation_Rate ) )
  
```

```{r}
#| include: False
library(tmap)
library( sf )
library( geodata )
library(tinytable)

us <- gadm( "USA", level = 2, path = getwd() )
us <- st_as_sf( us )

florida <- us |> filter( NAME_1 == "Florida")

tmap_mode("plot")

florida <- left_join( florida, Florida2023 |> rename( NAME_2 = county ) |> select( -rank ) )
```

  This graph depicts the Florida graduation rate on the Y-axis and the population density on the X-axis. In Florida, the higher population counties are typically found above the mean graduation rate(85%), and this seems to contradict our hypothesis. The highest population county, Pinellas, is in fact slightly above the mean  graduation rate at 87.6%. The least populace county is Liberty county which sits comfortably below the mean at 9.4 people per square mile. Again this contradicts our hypothesis. 
  
## Florida Graph
```{r}
#| echo: FALSE
### Florida Graph ###
Florida2023 |>
  ggplot(aes(x = densityMi, y = Graduation_Rate)) +
  geom_point() +
  labs( x = 'density', y = 'Grad Rate', title = 'Florida Data') + 
  xlim(0 , 3600) + ylim(65, 100)
```

  Florida's graduation rate is highest on average around the southern tip of the state. The panhandle has an interesting mix of counties with both very high graduation rates and also some of the lowest in the state. The middle of the state is fairly average but has a few standouts in both directions.

## Florida Graduation Rate Map

```{r}
#| echo: FALSE
#| message: FALSE
tm_shape( florida ) + 
  tm_polygons( id = "NAME_2", fill = "Graduation_Rate", palette = "greens", style= "jenks")
```

  The population is high in the southern tip and middle of Florida with a small group of counties clustered in the south with very low population densities. The pan handle is extremely sparse and only has about four counties with populations of any relevant size.

## Florida Population Density Map
```{r}
#| echo: FALSE
#| message: FALSE
tm_shape( florida ) +
  tm_polygons( id = "NAME_2", fill = "densityMi", palette = "blues", breaks = c(0, 50, 100, 200, 500, 1000, 1500, 2000, 3500))
```
  
  On average the counties with high population density performed around the mean of graduation rate while the counties of lower density had both the highest and lowest graduation rate. This lead us to speculate that there were factors at play that had more of an effect than the population density overall.

  






